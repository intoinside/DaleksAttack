
plugins {
    id "com.github.c64lib.retro-assembler" version "1.5.2"
}

repositories {
    mavenCentral()
}

apply plugin: "com.github.c64lib.retro-assembler"

retroProject {
    dialect = "KickAssembler"
    dialectVersion = "5.24"
    libDirs = [".ra/deps/c64lib"]
    srcDirs = ["."]
    excludes = ["**/_*.asm", ".ra/**/*", "libs/*"]

    // dependencies
    libFromGitHub "c64lib/common", "0.3.0"
    libFromGitHub "c64lib/chipset", "0.3.0"
}

preprocess {
    // Game charset, colors and maps
    charpad {
        getInput().set(file("./assets/map.ctm"))
        getUseBuildDir().set(false)
        outputs {
            charset {
                output = file("./assets/charset.bin")
            }
            charsetAttributes {
                nybbler {
                    loOutput = file("./assets/charcolors.bin")
                }
            }

    // Main map
            map {
                left = 0
                top = 0
                right = 40
                bottom = 25
                interleaver {
                    output = file("assets/mainmap.bin")
                }
                interleaver {
                }
            }
            map {
                left = 70
                top = 0
                right = 110
                bottom = 25
                interleaver {
                    output = file("assets/intro.bin")
                }
                interleaver {
                }
            }
            map {
                left = 40
                top = 0
                right = 50
                bottom = 12
                interleaver {
                    output = file("assets/dialogempty.bin")
                }
                interleaver {
                }
            }
            map {
                left = 50
                top = 0
                right = 60
                bottom = 12
                interleaver {
                    output = file("assets/nextlevel.bin")
                }
                interleaver {
                }
            }
            map {
                left = 40
                top = 12
                right = 50
                bottom = 24
                interleaver {
                    output = file("assets/dead.bin")
                }
                interleaver {
                }
            }
            map {
                left = 50
                top = 12
                right = 60
                bottom = 24
                interleaver {
                    output = file("assets/gameover.bin")
                }
                interleaver {
                }
            }
            map {
                left = 60
                top = 0
                right = 70
                bottom = 12
                interleaver {
                    output = file("assets/teleport.bin")
                }
                interleaver {
                }
            }
        }
    }
}
